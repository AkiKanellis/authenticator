// Adds a source set for the integration tests as well as a corresponding task.

sourceSets {
    integrationTest {
        compileClasspath += sourceSets.test.runtimeClasspath
        runtimeClasspath += sourceSets.test.runtimeClasspath
    }

    stressTest {
        compileClasspath += sourceSets.test.runtimeClasspath
        runtimeClasspath += sourceSets.test.runtimeClasspath
    }
}

task integrationTest(type: Test) {
    group 'verification'
    description = "Run the integration tests."

    testClassesDir = project.sourceSets.integrationTest.output.classesDir
    classpath = project.sourceSets.integrationTest.runtimeClasspath
}

task stressTest(type: Test) {
    group 'verification'
    description = "Run the stress tests."

    testClassesDir = project.sourceSets.stressTest.output.classesDir
    classpath = project.sourceSets.stressTest.runtimeClasspath
}

check.dependsOn integrationTest
check.dependsOn stressTest
integrationTest.mustRunAfter test
stressTest.mustRunAfter test

tasks.withType(Test) {
    reports.html.destination = file("${reporting.baseDir}/${name}")
}